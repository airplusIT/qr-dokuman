<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Yönlendirme Sayfası</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 100px; }
    #sifreAlani { display: none; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Hoş Geldiniz</h1>
  <p>Lütfen giriş türünüzü seçin:</p>
  <button onclick="girisSec('musteri')">Müşteri Girişi</button>
  <button onclick="girisSec('personel')">Personel Girişi</button>

  <div id="sifreAlani">
    <p>Personel şifrenizi girin:</p>
    <input type="password" id="sifre" />
    <button onclick="girisYap()">Giriş Yap</button>
  </div>

  <script>
    let secim = '';
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');

    // Desteklenen uzantılar
    const extensions = ['pdf', 'jpg', 'docx'];

    // Dosya var mı kontrolü için uzantıları sırayla dene
    function getDosyaYolu(tip) {
      for (let ext of extensions) {
        let yol = `docs/${tip}/${id}.${ext}`;
        // Sayfa var mı kontrolü için HEAD isteği
        let xhr = new XMLHttpRequest();
        xhr.open('HEAD', yol, false);
        xhr.send();
        if (xhr.status === 200) {
          return yol;
        }
      }
      return null;
    }

    function girisSec(tip) {
      secim = tip;
      if (tip === 'personel') {
        document.getElementById('sifreAlani').style.display = 'block';
      } else {
        let dosyaYolu = getDosyaYolu(tip);
        if (dosyaYolu) {
          window.location.href = dosyaYolu;
        } else {
          alert('Dosya bulunamadı!');
        }
      }
    }

    function girisYap() {
      const sifre = document.getElementById('sifre').value;
      if (sifre === '1234') {
        let dosyaYolu = getDosyaYolu('personel');
        if (dosyaYolu) {
          window.location.href = dosyaYolu;
        } else {
          alert('Dosya bulunamadı!');
        }
      } else {
        alert('Şifre yanlış!');
      }
    }
  </script>
</body>
</html>
